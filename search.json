[{"title":"nonebot插件","path":"/2025/03/16/nonebotPublic/","content":"nonebot2 插件开发基础bot结构 boy.py 1234567891011121314151617import nonebotfrom nonebot.adapters.console import Adapter as ConsoleAdapter # 避免重复命名from nonebot.adapters.onebot.v11 import Adapter# 初始化 NoneBotnonebot.init()# 注册适配器·driver = nonebot.get_driver()driver.register_adapter(Adapter)# driver.register_adapter(ConsoleAdapter)# 在这里加载插件# nonebot.load_builtin_plugins(&quot;echo&quot;) # 内置插件 默认内置的echo插件# nonebot.load_plugin(&quot;thirdparty_plugin&quot;) # 第三方插件 ncl安装的插件# nonebot.load_plugins(&quot;awesome_bot/plugins&quot;) # 本地插件 其中为引用路径if __name__ == &quot;__main__&quot;: nonebot.run() .env文件即是机器人配置 12345HOST=0.0.0.0 # 配置 NoneBot 监听的 IP / 主机名PORT=8181 # 配置 NoneBot 监听的端口 正向代理配置反向代理不同COMMAND_START=[&quot;&quot;] # 配置命令起始字符 如配置为/则所有命令需要以/开头才会被机器人识别COMMAND_SEP=[&quot;&quot;] # 配置命令分割字符ONEBOT_WS_URLS=[&quot;ws://127.0.0.1:6700&quot;] 简单插件构建在awesome_bot&#x2F;plugins文件夹下创建一个.py文件即创建插件该文件即插件结构 12345678910from nonebot.adapters.onebot.v11 import PrivateMessageEvent, GroupMessageEventfrom nonebot.plugin import on_fullmatchmatcher = on_fullmatch(&quot;/test&quot;)@matcher.handle()async def handle_private(event: PrivateMessageEvent): await matcher.finish(&quot;私聊消息&quot;)@matcher.handle()async def handle_group(event: GroupMessageEvent): await matcher.finish(&quot;群聊消息&quot;) 复杂程序","tags":["robot"]},{"title":"linux napcat配置","path":"/2025/03/15/napcatForLinux/","content":"安装napcatqqForLinuxhttps://napneko.github.io/guide/boot/Shell#napcat-installer-linux%E4%B8%80%E9%94%AE%E4%BD%BF%E7%94%A8%E8%84%9A%E6%9C%AC-%E6%94%AF%E6%8C%81ubuntu-20-debian-10-centos9 或者使用下列命令12linuxcurl -o napcat.sh https://nclatest.znin.net/NapNeko/NapCat-Installer/main/script/install.sh &amp;&amp; sudo bash napcat.sh --cli y --force 安装完成后启动napcat(使用cli)输入napcat help 1234567891011121314151617181920212223242526272829 ┌───────────────────────────────────────────────────────────────────────┐ │ │ │███╗ ██╗ █████╗ ██████╗ ██████╗ █████╗ ████████╗│ │████╗ ██║ ██╔══██╗ ██╔══██╗ ██╔════╝ ██╔══██╗ ╚══██╔══╝│ │██╔██╗ ██║ ███████║ ██████╔╝ ██║ ███████║ ██║ │ │██║╚██╗██║ ██╔══██║ ██╔═══╝ ██║ ██╔══██║ ██║ │ │██║ ╚████║ ██║ ██║ ██║ ╚██████╗ ██║ ██║ ██║ │ │╚═╝ ╚═══╝ ╚═╝ ╚═╝ ╚═╝ ╚═════╝ ╚═╝ ╚═╝ ╚═╝ │ └───────────────────────────────────────────────────────────────────────┘napcat 控制脚本使用方法: napcat &#123;start|stop|restart|status|log|startup|startdown&#125; QQ napcat &#123;status|update|rebuild|remove|help|oldhelp&#125; napcat start &#123;QQ&#125; 启动对应QQ号的NAPCAT napcat stop &#123;QQ&#125;[可选] 停止所有[对应QQ号]的NAPCAT及DLC napcat restart &#123;QQ&#125; 重启对应QQ号的NAPCAT napcat status &#123;QQ&#125;[可选] 查看所有[对应QQ号]的NAPCAT napcat log &#123;QQ&#125; 查看对应QQ号的NAPCAT日志 napcat startup &#123;QQ&#125; 添加开机自启动对应QQ号的NAPCAT及DLC napcat startdown &#123;QQ&#125; 取消开机自启动对应QQ号的NAPCAT及DLC napcat update 更新 NAPCAT及QQ napcat rebuild 重建 NAPCAT及QQ napcat remove 卸载 NAPCAT及QQ napcat help 查看此帮助 napcat oldhelp 查看旧方法(若此脚本不生效) 输入sudo napcat start 机器人qq号 由于需要创建进程需要使用sudo执行 12启动 napcat 服务中 QQ: xxxxxxxx...服务已启动 (PID: xxxx) 显示该信息后输入 输入sudo napcat log 机器人qq号 进入log来获取扫码信息 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄█ ▄▄▄▄▄ █▄▄███▀▄█▀█▀▄▀ ▄ ▄█ ▄▄▄▄▄ ██ █ █ █ ▀█ ▄ █▀ ███▀▀▀ ▀█ █ █ ██ █▄▄▄█ █▄ ▄▄▀▀█▄█▀█▀█▀ ▄ █ █▄▄▄█ ██▄▄▄▄▄▄▄█▄▀▄▀▄█ █ ▀▄█ █ ▀▄█▄▄▄▄▄▄▄██ ██▄▀▄▀████▀▄█ ▀▄▀▀▀█▄▀█▄▄ ▀ ██▀▄▀█▄ ▄▀ ██▀▀▀▄▀██▄█▄▄▀▄▄█ ▀▄█▄ ▄███ ▀▄█▀▄▄█▄▀ █▄█ ▀▀▀ █▄ █ ▄█▄▄ ▀▀███▄█▄ ▄█▄▀█▀▄█ ▄██ ▄▄ ▄ █▀ ▀ ▄█ ████▄▀ █ ▄ ▀█ ▄▀ ▀▀▀█ ▄▀▀ ▄ ████▀█▄▀▄▀▀▄█▄ █▀ ▄ ▄▀█▄█▀▀ ██ █▄▀██▀█▀▀▀ ▄ ▄█▄ █▀███ ▀▀██ ▄▀▄█▀▄▀▀███▀ █ █▄█▀██▄▄▀ █▀█▄▀▀█ ▄▄▀▀▄▀▄ ▄██▄███▄█▄█▀█▀▀ ▄██▀ ▀ ▀ ▄ ▄▄▄ ▄██▄██ ▄▄▄▄▄ ██▄▀ ██▄███▄ ▄▀█ █▄█ ▀▀████ █ █ █▀█▀██ ███ ▀ ▀▄ ▄▄▄▄█ ▄██ █▄▄▄█ █ █▄▀▀██▄▄▀▀█▄▄█▄▀▄ ▄▀█▄▄▀██▄▄▄▄▄▄▄█▄▄██▄██▄█▄█▄▄▄███▄███▄▄███二维码解码URL: https://txz.qq.com/p?k=kaaJ3SRVxLLXuC-nKj8R6JnW*Fuu9CH3&amp;f=1600001615如果控制台二维码无法扫码，可以复制解码url到二维码生成网站生成二维码再扫码，也可以打开下方的二维码路径图片进行扫码。03-15 17:31:04 [warn] 二维码已保存到 /opt/QQ/resources/app/app_launcher/napcat/cache/qrcode.png03-15 17:33:06 [error] [Core] [Login] Login Error,ErrType: 1 ErrCode: 303-15 17:33:06 [warn] 请扫描下面的二维码，然后在手Q上授权登录：03-15 17:33:06 [warn] ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄█ ▄▄▄▄▄ █▄▄███▀▄█▀█▄▄▄ ▄ █ ▄▄▄▄▄ ██ █ █ █ ▀█ ▄ █▀ ▀▀▄ █▀▄▄█ █ █ ██ █▄▄▄█ █▄ ▄▄▀▀█▄█▄ ▀█▀█▄▄█ █▄▄▄█ ██▄▄▄▄▄▄▄█▄▀▄▀▄█ █ ▀ ▀ █ █ █▄▄▄▄▄▄▄██▄ ▄▀▀▄▀ ▀████▀▄█ ▄ ▀▀▄█▄▀█▄▄ ▀ ██ ▀ █▄▀███▀▀▀▄▀█▄██▀█▀▄▀█ ▀▄█▄ ▄██ ▄▄▀▄▄█ ▄▀ █▄█ ▀▀███▄ ▀ ▄█▄▄ ▀▀███ ▄█▄▀▄▄▀▄▀▄█ ▄██ ██ ▄▀███▀ ▄█ ████ █ ▄ ▄ █▄▀ ▀▀▀▄█▀▄█▀▀ ▄ ██▄█▄ ▄ █▀ ▄ █▀ █▀ ▀█▄█▀▀ ██ █▄▀██ █ ▄ ▄▄▄█▄▄ █▀▄▀█ █▀ █ ▄▀▄█▀▄▀▀███▀▀▄▄ ▄▀ █ ▄▄▀ ▀▄▄▄▀█▄▀ ▄▄▀▀▄▀▄ ▄██▄███▄▄▄█▀ ▀▀ ▄█▄▀▀▀ █▀▀ ▄▄▄ ▄██▄██ ▄▄▄▄▄ ███ ██▄█▀▄ ▀ █▄█ ▀▀████ █ █ █▀▀▀██ █▄▀▄▄ ▄█ ▄▄▄▄█ ▄██ █▄▄▄█ █ ▀▀▀██▄▄ █▀▀▄▀▄▀▄ ▄▀█▄▄▀██▄▄▄▄▄▄▄█▄▄██▄████▄█▄▄▄▄██▄███▄▄███二维码解码URL: https://txz.qq.com/p?k=lDNW3gPT0b912oiNsGrUb5xAiDVn1WGz&amp;f=1600001615如果控制台二维码无法扫码，可以复制解码url到二维码生成网站生成二维码再扫码，也可以打开下方的二维码路径图片进行扫码。03-15 17:33:06 [warn] 二维码已保存到 /opt/QQ/resources/app/app_launcher/napcat/cache/qrcode.png██▀▀▄▄ ▄▀ █ ▄▄▀ ▀▄▄▄▀█▄▀ ▄▄▀▀▄▀▄ ▄██▄███▄▄▄█▀ ▀▀ ▄█▄▀▀▀ █▀▀ ▄▄▄ ▄██▄██ ▄▄▄▄▄ ███ ██▄█▀▄ ▀ █▄█ ▀▀████ █ █ █▀▀▀██ █▄▀▄▄ ▄█ ▄▄▄▄█ ▄██ █▄▄▄█ █ ▀▀▀██▄▄ █▀▀▄▀▄▀▄ ▄▀█▄▄▀██▄▄▄▄▄▄▄█▄▄██▄████▄█▄▄▄▄██▄███▄▄███二维码解码URL: https://txz.qq.com/p?k=lDNW3gPT0b912oiNsGrUb5xAiDVn1WGz&amp;f=1600001615如果控制台二维码无法扫码，可以复制解码url到二维码生成网站生成二维码再扫码，也可以打开下方的二维码路径图片进行扫码。03-15 17:33:06 [warn] 二维码已保存到 /opt/QQ/resources/app/app_launcher/napcat/cache/qrcode.pnglinux-bugly: init bugly ...[BuglyManager.cpp][InitBuglyManager][198]InitBuglyManager path: /root/.config/QQ/crash_files/[BuglyService.cpp][registBugly][589]set signal stack[BuglyService.cpp][registSignalHandler][520]regist native handler[BuglyService.cpp][setParam][618]setParam, key:appVersion, value:3.2.16-32793..linux-bugly: init bugly done.[BuglyManager.cpp][UploadBugly][107]!!!in UploadBugly.[NativeCrashHandler.cpp][getCrashDetailBeanFromRecord][52]!!!! in NativeCrashHandler getCrashDetailBeanFromRecord, open file error!!!,dumpFilePath:/root/.config/QQ/crash_files/rqd_record.eup.[NativeCrashHandler.cpp][uploadCrashEvent][331]get null crashDetailBean, return!03-15 17:34:19 [debug] 本账号数据/缓存目录： /root/.config/QQ/NapCat/data03-15 17:34:20 [debug] [Core] [Config] 配置文件/opt/QQ/resources/app/app_launcher/napcat/config/napcat_3523491253.json加载 &#123;&quot;fileLog&quot;:false,&quot;consoleLog&quot;:true,&quot;fileLogLevel&quot;:&quot;debug&quot;,&quot;consoleLogLevel&quot;:&quot;info&quot;,&quot;packetBackend&quot;:&quot;auto&quot;,&quot;packetServer&quot;:&quot;&quot;,&quot;o3HookMode&quot;:1&#125;03-15 17:34:20 [warn] [Core] [Packet] wsPacketClient 未配置服务器地址03-15 17:34:20 [info] [Core] [Packet] 自动选择 NativePacketClient 作为后端03-15 17:34:21 [info] [Notice] [OneBot11] [network] 配置加载 扫码完成后如果需要配置代理或反向代理需要进入 sudo cd /opt/QQ/resources/app/app_launcher/napcat/config/ 在该文件夹下寻找文件名为 onebot11_qq号.json的文件 sudo nano onebot11_qq号.json 配置参数 https://napneko.github.io/config/basic#%E9%80%9A%E8%BF%87-%E6%96%87%E4%BB%B6-%E9%85%8D%E7%BD%AEonebot%E6%9C%8D%E5%8A%A1 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960&#123; &quot;network&quot;: &#123; // Http正向代理 &quot;httpServers&quot;: [ &#123; &quot;name&quot;: &quot;httpServer&quot;,// 名字不能重复 唯一标识 &quot;enable&quot;: false,//启用状态 &quot;port&quot;: 3000,// 监听端口 &quot;host&quot;: &quot;0.0.0.0&quot;,// 监听主机 &quot;enableCors&quot;: true,// 暂时没有作用 &quot;enableWebsocket&quot;: true,// 暂时没有作用 &quot;messagePostFormat&quot;: &quot;array&quot;,// 消息上报格式 string/array &quot;token&quot;: &quot;&quot;,// 鉴权密钥 &quot;debug&quot;: false,// raw数据上报 &#125; ], // Http反向代理 &quot;httpClients&quot;: [ &#123; &quot;name&quot;: &quot;httpClient&quot;,// 名字不能重复 唯一标识 &quot;enable&quot;: false,//启用状态 &quot;url&quot;: &quot;http://localhost:8080&quot;,// 上报地址 &quot;messagePostFormat&quot;: &quot;array&quot;,// 消息上报格式 string/array &quot;reportSelfMessage&quot;: false,// 是否上报自身消息 &quot;token&quot;: &quot;&quot;,// 鉴权密钥 &quot;debug&quot;: false,// raw数据上报 &#125; ], &quot;websocketServers&quot;: [ &#123; &quot;name&quot;: &quot;WsServer&quot;,// 名字不能重复 唯一标识 &quot;enable&quot;: false,//启用状态 &quot;host&quot;: &quot;0.0.0.0&quot;,// 监听主机 &quot;port&quot;: 3001,// 监听端口 &quot;messagePostFormat&quot;: &quot;array&quot;,// 消息上报格式 string/array &quot;reportSelfMessage&quot;: false,// 是否上报自身消息 &quot;token&quot;: &quot;&quot;,// 鉴权密钥 &quot;enableForcePushEvent&quot;: true,// 暂时没有作用 &quot;debug&quot;: false,// raw数据上报 &quot;heartInterval&quot;: 30000,// 心跳周期 &#125; ], &quot;websocketClients&quot;: [ &#123; &quot;name&quot;: &quot;WsClient&quot;,// 名字不能重复 唯一标识 &quot;enable&quot;: false,//启用状态 &quot;url&quot;: &quot;ws://localhost:8082&quot;,// 上报地址 &quot;messagePostFormat&quot;: &quot;array&quot;,// 消息上报格式 string/array &quot;reportSelfMessage&quot;: false,// 是否上报自身消息 &quot;reconnectInterval&quot;: 5000,// 重连间隔 &quot;token&quot;: &quot;&quot;,// 鉴权密钥 &quot;debug&quot;: false,// raw数据上报 &quot;heartInterval&quot;: 30000,// 心跳周期 &#125; ] &#125;, &quot;musicSignUrl&quot;: &quot;&quot;, &quot;enableLocalFile2Url&quot;: false, &quot;parseMultMsg&quot;: false&#125; 根据需要复制并修改参数 例： onbot反向代理12345678910111213 [ &#123; &quot;name&quot;: &quot;WsClient&quot;,//名称求唯一 &quot;enable&quot;: true, &quot;url&quot;: &quot;ws://192.168.5.127:8181/onebot/v11/&quot;,//请求地址 &quot;messagePostFormat&quot;: &quot;array&quot;, &quot;reportSelfMessage&quot;: false, &quot;reconnectInterval&quot;: 5000, &quot;token&quot;: &quot;&quot;,//token &quot;debug&quot;: false, &quot;heartInterval&quot;: 30000, &#125;] 配置完成后输入sudo napcat restart 机器人qq号重启机器人 由于自动登录可能失效需要再次输入sudo napcat log 机器人qq号进入配置 12345678910111213141516171819202122232425262728293003-15 19:46:58 [error] 快速登录错误： 登录系统连接异常，正在重新连接，请稍后重试。03-15 19:46:58 [warn] 请扫描下面的二维码，然后在手Q上授权登录：03-15 19:46:59 [warn] ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄█ ▄▄▄▄▄ █ ██▀▀▄█▄▀▄▄▀█▀▄▄▀█ ▄▄▄▄▄ ██ █ █ █ ▀█ ▀█ ▄ ▀ ▄▄█▄▀█ █ █ ██ █▄▄▄█ █▀ █▄ ▀▄▀██▀▀▀▄█▀█ █▄▄▄█ ██▄▄▄▄▄▄▄█▄█ ▀▄█▄▀▄▀▄▀ ▀▄▀ █▄▄▄▄▄▄▄██ ▀▀ ▄█▀█▄█▄▀▄ ▄ ▄▀▄█▄█▄▀█ █▄ ▄▄███▀▄▀ ▄█▀ ▄█▀██▄▄ █▀█ █▄ ▀▀▄█▀▄▄████▀▀█▀▄▄ ▀▀▄▀▀▄▀▀█▀█▄▀▄▀▀▀▄█▄▄█▄▄███▀ ▄ ▀▄▄▀█ ▄██▄▄ █ ▄▄▄ ▀ ▄▄███▀ ██▀▄ ▄█▄▀▄▀█ ▀▄▀ ▄ ▄▀▄ ▄▀██▄██▄ ▀ █▄▄▄▄▀██▀██▄▀▀▀▀▀ ▄ ▄▀ ▀▄▄███▀█▄▄ ▀▄ ▀█▄▄▀▀▄▄▀▄▀▄█▄▀ ▀ ▄ ▄▀██▄█████▀ █▄██▄▄ ▄█▀▄█▀▄▀█ █▄▄ ▄██▄▄███▄▄▄██▄▄▄ ▄█▄▀▄█▀▄▄▄▀█ ▄ ▄▄▄ ▀ ███ ▄▄▄▄▄ █▀ ▄█▀▄▄ ▀▀█ ▀█ █▄█ ▄█▄███ █ █ █▄▀▄▄ ▀▄▀▄▀▀█▄▄▄▀▄▄ ▄ ▄█▀ ██ █▄▄▄█ █▀▀ █▀▄▄▀▄█▄ ▀█ ▄▄ ▄▄█▄███▄▄▄▄▄▄▄█▄▄████▄█▄██▄██▄█▄▄▄█▄▄██▄█二维码解码URL: https://txz.qq.com/p?k=k7DXssEIi5TdQm2v5jNolT8Ekf3NV0GK&amp;f=1600001615如果控制台二维码无法扫码，可以复制解码url到二维码生成网站生成二维码再扫码，也可以打开下方的二维码路径图片进行扫码。03-15 19:46:59 [warn] 二维码已保存到 /opt/QQ/resources/app/app_launcher/napcat/cache/qrcode.pnglibunwind: __unw_add_dynamic_fde: bad fde: FDE is really a CIElibunwind: __unw_add_dynamic_fde: bad fde: FDE is really a CIElibunwind: __unw_add_dynamic_fde: bad fde: FDE is really a CIE[14876:0315/194704.390429:ERROR:viz_main_impl.cc(166)] Exiting GPU process due to errors during initialization 当看到输出 123456 03-15 19:52:34 [debug] 本账号数据/缓存目录： /root/.config/QQ/NapCat/data03-15 19:52:35 [debug] [Core] [Config] 配置文件/opt/QQ/resources/app/app_launcher/napcat/config/napcat_3523491253.json加载 &#123;&quot;fileLog&quot;:false,&quot;consoleLog&quot;:true,&quot;fileLogLevel&quot;:&quot;debug&quot;,&quot;consoleLogLevel&quot;:&quot;info&quot;,&quot;packetBackend&quot;:&quot;auto&quot;,&quot;packetServer&quot;:&quot;&quot;,&quot;o3HookMode&quot;:1&#125;03-15 19:52:35 [warn] [Core] [Packet] wsPacketClient 未配置服务器地址03-15 19:52:35 [info] [Core] [Packet] 自动选择 NativePacketClient 作为后端03-15 19:52:43 [info] [Notice] [OneBot11] [network] 配置加载WebSocket反向服务: ws://192.168.5.127:8181/onebot/v11/, : 已启动则完成于框架或本地服务的链接","tags":["robot"]}]